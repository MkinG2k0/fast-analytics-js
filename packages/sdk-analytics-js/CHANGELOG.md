# Changelog

Все значимые изменения в проекте будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [0.6.4] - 2024-12-XX

### Добавлено

- **Игнорирование ошибок по кодам и URL**: Добавлена опция `ignoreError` в `InitOptions`, позволяющая фильтровать ошибки по HTTP кодам статуса и URL паттернам. Это помогает исключить из отслеживания известные или некритичные ошибки.
  - Поддержка фильтрации по кодам статуса: `ignoreError: { codes: [404, 403, '500'] }`
  - Поддержка фильтрации по URL паттернам с использованием wildcards: `ignoreError: { urls: ['/api/health*', '*/static/*'] }`
  - Функция `shouldIgnoreError()` для проверки необходимости игнорирования ошибки

- **Группировка посещений страниц**: Добавлена опция `groupPageVisitsGroup` в `InitOptions` для группировки похожих страниц по паттернам. Это позволяет объединять динамические маршруты в одну группу для более удобной аналитики.
  - Поддержка паттернов с wildcards: `groupPageVisitsGroup: ['/users/*', '/posts/*/edit']`
  - Функция `groupPageVisitPathname()` для группировки pathname по паттернам
  - Интеграция с `PageVisitTracker` для автоматической группировки при отслеживании посещений

### Изменено

- Обновлена логика перехватчиков (`fetch-interceptor`, `xhr-interceptor`) для поддержки фильтрации ошибок через `ignoreError`
- Улучшена обработка ошибок в `Interceptors` с учетом настроек `ignoreError`
- Обновлена документация в README.md с примерами использования новых функций

### Технические детали

- Добавлен новый модуль `lib/should-ignore-error.ts` для проверки необходимости игнорирования ошибок
- Добавлен новый модуль `lib/group-page-visit.ts` для группировки pathname по паттернам
- Обновлены типы в `model/types.ts` для поддержки новых опций конфигурации

## [0.6.3] - 2024-12-XX

### Исправлено

- Исправлена проверка прав доступа `manageSettings` в тестах проектов

## [0.6.2] - 2024-12-XX

### Добавлено

- Улучшена документация по отслеживанию онлайн пользователей в README.md

### Изменено

- Обновлена логика heartbeat для отслеживания онлайн пользователей
- Улучшена интеграция с провайдером аналитики

## [0.6.0] - 2024-12-XX

### Изменено

- Рефакторинг отображения скриншотов в компоненте деталей событий
- Улучшен layout и пользовательский опыт при просмотре скриншотов ошибок

## [0.5.2] - 2024-12-XX

### Добавлено

- Улучшена аналитика посещений страниц с модификацией логики ключей строк
- Добавлены кастомные стили скроллбара для истории событий
- Рефакторинг layout компонентов для улучшения читаемости
- Обновлена логика маршрутизации в AuthLayout для включения корневого пути как публичного маршрута

### Изменено

- Улучшена обработка ключей строк в аналитике посещений страниц

## [0.5.0] - 2024-12-XX

### Добавлено

- **Поддержка скриншотов**: Добавлена опциональная поддержка скриншотов при возникновении ошибок с использованием `html2canvas-pro`
  - Опция `enableScreenshotOnError` в `InitOptions` для включения скриншотов
  - Автоматическое создание скриншотов при перехвате ошибок
  - Поддержка современных CSS цветов (oklch, lab, lch) при использовании `html2canvas-pro`
  - Поле `screenshotUrl` в `EventPayload` для хранения URL скриншота

### Изменено

- Обновлен payload событий для включения URL скриншотов
- Улучшена документация по использованию скриншотов

## [0.4.0] - 2024-12-XX

### Добавлено

- **Отслеживание посещений страниц**: Добавлена функциональность автоматического отслеживания посещений страниц
  - Автоматическое отслеживание переходов в SPA приложениях
  - Поддержка History API (pushState, replaceState, popstate)
  - Отслеживание времени на странице (duration)
  - Отдельный транспорт для отправки данных о посещениях (`PageVisitTransport`)
  - Класс `PageVisitTracker` для управления отслеживанием посещений
  - Опция `enablePageTracking` в `InitOptions` для включения/выключения отслеживания

### Изменено

- Обновлена архитектура SDK для поддержки множественных транспортов

## [0.3.1] - 2024-12-XX

### Добавлено

- Обновлен UI аналитики посещений страниц
- Улучшена документация в README с новыми возможностями, примерами использования и поддержкой TypeScript

### Изменено

- Удален заголовок из аналитики посещений страниц
- Изменен цвет статистики средней продолжительности посещения

## [0.3.0] - 2024-12-XX

### Добавлено

- **Отслеживание онлайн пользователей**: Добавлена функциональность отслеживания онлайн пользователей в реальном времени
  - Интеграция с Upstash Redis для хранения данных об онлайн пользователях
  - Heartbeat механизм для отслеживания активности пользователей
  - Опция `enableOnlineTracking` в `InitOptions` для включения отслеживания
  - Опция `heartbeatInterval` для настройки интервала heartbeat
  - Класс `HeartbeatTransport` для отправки heartbeat запросов

### Изменено

- Улучшена аналитика посещений страниц с обновлениями в реальном времени

## [0.2.0] - 2024-12-XX

### Добавлено

- Базовая функциональность SDK для отправки логов и ошибок
- Автоматический перехват ошибок браузера
- Поддержка ручного логирования (logError, logWarning, logInfo, logDebug)
- Управление сессиями
- Пакетная обработка событий
- Поддержка TypeScript
