# E2E тесты

Этот каталог содержит end-to-end тесты, написанные с использованием [Playwright](https://playwright.dev/).

## Установка

Браузеры уже установлены. Если нужно установить заново:

```bash
pnpm exec playwright install --with-deps chromium
```

## Запуск тестов

```bash
# Запустить все e2e тесты
pnpm test:e2e

# Запустить с UI режимом (интерактивный)
pnpm test:e2e:ui

# Запустить в режиме отладки
pnpm test:e2e:debug

# Генератор кода для создания тестов
pnpm test:e2e:codegen
```

## Структура

### Тесты

- `example.spec.ts` - базовые тесты для главной страницы, входа и регистрации
- `auth.spec.ts` - тесты авторизации и регистрации
- `projects.spec.ts` - тесты работы с проектами (список, создание, навигация)
- `events.spec.ts` - тесты работы с событиями/логами

### Фикстуры

- `fixtures/mocks.ts` - моковые данные (пользователи, проекты, события)
- `fixtures/api-mocks.ts` - функции для мокирования API запросов
- `fixtures/index.ts` - экспорт всех фикстур

## Мокирование API

Все тесты используют мокирование API запросов через `page.route()`. Это позволяет:

- Тестировать UI без зависимости от реального бэкенда
- Быстро выполнять тесты
- Тестировать различные сценарии (ошибки, пустые данные и т.д.)

Моки настраиваются автоматически через `setupApiMocks()` в каждом тесте.

## Покрытие тестами

### Авторизация
- ✅ Отображение формы входа
- ✅ Отображение формы регистрации
- ✅ Валидация полей регистрации
- ✅ Успешная регистрация
- ✅ Обработка ошибок регистрации

### Проекты
- ✅ Отображение списка проектов
- ✅ Пустое состояние
- ✅ Создание проекта
- ✅ Валидация формы создания
- ✅ Навигация к логам и настройкам проекта
- ✅ Пагинация

### События
- ✅ Отображение списка событий
- ✅ Фильтрация событий
- ✅ Обновление списка
- ✅ Пагинация
- ✅ Детали события

## Конфигурация

Настройки находятся в `playwright.config.ts` в корне проекта.

## Переменные окружения

- `PLAYWRIGHT_TEST_BASE_URL` - базовый URL для тестов (по умолчанию `http://localhost:3000`)
- `CI` - автоматически устанавливается в CI/CD окружениях

## Примечания

- Тесты автоматически запускают dev сервер перед выполнением
- Все API запросы мокируются, реальный бэкенд не требуется
- Для тестирования авторизации используется мокирование NextAuth сессии

